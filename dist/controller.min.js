var app=angular.module("myApp",["ui.router","ngAlertify"]);app.constant("apiUrl","http://test.xpcc.com.cn:8002/"),app.constant("socketUrl","http://test.xpcc.com.cn:4500/"),app.run(["alertify",function(t){t.maxLogItems(1).delay(3e3).okBtn("确认").cancelBtn("取消")}]),app.config(["$stateProvider","$urlRouterProvider",function(t,e){e.when("","/login"),e.when("/","/login"),e.when("/feed","/feed/shotCut"),e.when("/feed/","/feed/shotCut"),e.otherwise("/404"),t.state("error",{url:"/404",template:'<div class="text-center"><h1>页面不存在404！</h1>'}).state("login",{url:"/login",templateUrl:"./module/login/login.html",controller:"loginController"}).state("admin",{url:"/admin",templateUrl:"./module/admin/admin.html",controller:"adminController"}).state("admin.branch",{url:"/branch",templateUrl:"./module/branch/branch.html",controller:"branchController"}).state("admin.launch",{url:"/launch",templateUrl:"./module/branch/launch.html",controller:"launchController"})}]);
app.directive("hello",function(){return{restrict:"EA",replace:!0,scope:{tempTitle:"=",tempLs:"@",ngJudge:"=",myClick:"&"},link:function(e,a,t){e.setCheck=function(a){e.ngJudge=a,e.myClick()}},template:"<div class = 'tab'>{{tempLs}}<span ng-class='{active: ngJudge == $index}' ng-repeat='val in tempTitle track by $index' ng-click = 'setCheck($index)'>{{val}}</span></div>"}}),app.directive("tqqPagination",function(){function e(e,a,t,s){var n=[],i=Math.ceil(e/a),l=Math.ceil(t/2),g=Math.floor(t/2);if(i<=t)for(var r=1;r<=i;r++)n.push(r);else if(s<=l)for(var p=1;p<=t;p++)n.push(p);else if(s>l&&s+g<=i){var c=s-l+1,d=s-l+t;for(c;c<=d;c++)n.push(c)}else if(s>l&&s+g>i)for(var o=i-t+1;o<=i;o++)n.push(o);return n}function a(e,a){for(var t=[],s=Math.ceil(e/a),n=1;n<=s;n++)t.push(n);return t}return{restrict:"EA",replace:!0,scope:{totalItems:"=",maxSize:"=",itemsPerPage:"=",ngModel:"=",hideLast:"=",tqqChange:"&",itemSelectHide:"="},link:function(t,s,n,i){if(t.atrs=n,!n.ngModel)throw'"ng-model" is undefined \n 中文:"ng-model"为必传参数。';if(!n.itemsPerPage)throw'"items-per-page" is undefined \n 中文:"items-per-page"为必传参数。';if(!n.totalItems)throw'"total-items" is undefined \n 中文:"total-items"为必传参数。';var l,g,r;t.ngModel=t.ngModel||1,t.pageNum=Math.ceil(t.totalItems/(t.itemsPerPage||10)),t.pageArr=e(t.totalItems,t.itemsPerPage||10,t.maxSize||5,t.ngModel||1),t.allPageArr=a(t.totalItems,t.itemsPerPage||10),t.judge={first:"first",previous:"previous",next:"next",last:"last"},t.$watch("ngModel",function(a,s){l&&(t.pageArr=e(t.totalItems,t.itemsPerPage||10,t.maxSize||5,t.ngModel||1),t.tqqChange()),l=!0}),t.$watch("totalItems",function(s,n){s>0&&n>0&&(t.ngModel=1),g&&(t.pageArr=e(t.totalItems,t.itemsPerPage||10,t.maxSize||5,t.ngModel||1),t.allPageArr=a(t.totalItems,t.itemsPerPage||10),t.pageNum=Math.ceil(t.totalItems/(t.itemsPerPage||10))),g=!0}),t.$watch("itemsPerPage",function(){r&&(t.ngModel>1?t.ngModel=1:t.tqqChange(),t.pageArr=e(t.totalItems,t.itemsPerPage||10,t.maxSize||5,t.ngModel||1),t.allPageArr=a(t.totalItems,t.itemsPerPage||10),t.pageNum=Math.ceil(t.totalItems/(t.itemsPerPage||10))),r=!0}),t.updatePage=function(e){switch(e){case t.judge.first:t.ngModel=1;break;case t.judge.previous:t.ngModel>1&&t.ngModel--;break;case t.judge.next:t.ngModel<t.pageNum&&t.ngModel++;break;case t.judge.last:t.ngModel=t.pageNum;break;default:t.pageSelect=!1,t.ngModel=e}},t.updateItem=function(e){t.pageSelect=!1,t.itemsPerPage=e},t.updateShow=function(){t.pageSelect=!t.pageSelect},t.dismissSelect=function(){t.pageSelect=!1}},template:'<nav><div class="page-box" ng-if="pageSelect" ng-click="dismissSelect()"></div><ul class="pagination mg-none {{atrs.sizeClass}}"><li ng-if="!hideLast" ng-class="{disabled:ngModel===1}"><a href  ng-click="updatePage(judge.first)"><span ng-if="atrs.firstText">{{atrs.firstText}}</span><span  ng-if="!atrs.firstText"　class="anniu">&laquo;</span></a></li><li ng-class="{disabled:ngModel===1}"><a href  ng-click="updatePage(judge.previous)"><span ng-if="atrs.previousText">{{atrs.previousText}}</span><span  ng-if="!atrs.previousText"　class="anniu">&lsaquo;</span></a></li><li ng-repeat="val in pageArr track by $index" ng-class="{active:ngModel===val}"><a href ng-click="updatePage(val)">{{val}}</a></li><li ng-class="{disabled:ngModel===pageNum}"><a href  ng-click="updatePage(judge.next)"><span ng-if="atrs.nextText">{{atrs.nextText}}</span><span  ng-if="!atrs.nextText"　class="anniu">&rsaquo;</span></a></li><li ng-if="!hideLast" ng-class="{disabled:ngModel===pageNum}"><a href  ng-click="updatePage(judge.last)"><span ng-if="atrs.lastText">{{atrs.lastText}}</span><span  ng-if="!atrs.lastText"　class="anniu">&raquo;</span></a></li></ul><ul ng-if="!itemSelectHide" class="pagination pagination-init page-num-this {{atrs.sizeClass}}"><li><a href ng-click="updateShow()" ng-class="{active:pageSelect}">{{ngModel}}/{{pageNum}}</a><div class="page-list" ng-show="pageSelect"><div>每页显示</div><span ng-repeat="data in [10,20,50,100,200] track by $index" ng-class="{active:itemsPerPage===data}" ng-click="updateItem(data)">{{data}}</span><div>页&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp码</div><span ng-repeat="data in allPageArr track by $index" ng-class="{active:ngModel===data}" ng-click="updatePage(data)">{{data}}</span></div>'}});
app.filter("trustHtml",["$sce",function(t){return function(r){return t.trustAsHtml(r)}}]);
app.service("clone",function(){this.cloneObj=function(e){var o;o=e.constructor==Object?new e.constructor:new e.constructor(e.valueOf());for(var r in e)o[r]!=e[r]&&("object"==typeof e[r]?o[r]=this.obj(e[r]):o[r]=e[r]);return o}}),app.service("myCookie",function(){this.getCookie=function(e){var o,r=new RegExp("(^| )"+e+"=([^;]*)(;|$)");return(o=document.cookie.match(r))?unescape(o[2]):null},this.setCookie=function(e,o,r,t,n){var i=new Date;n=n?n:1,i.setTime(i.getTime()+24*n*60*60*1e3);var c=";expires="+i.toUTCString();document.cookie=e+"="+o+(r?";path="+r:"")+(t?";domain="+t:"")+c},this.clearCookie=function(e,o,r){this.getCookie(e)&&(document.cookie=e+"="+(o?";path="+o:"")+(r?";domain="+r:"")+";expires=Thu, 01 Jan 1970 00:00:01 GMT")},this.checkCookie=function(){var e=this.getCookie("username");""!=e||(e=prompt("Please enter your name:",""),""!=e&&null!=e&&setCookie("username",e,365))}}),app.service("myHttp",["$q","$http","apiUrl","$state","alertify","myCookie",function(e,o,r,t,n,i){function c(c,s,a,u){var l=e.defer(),p={method:c,url:r+s,headers:{token:i.getCookie("auth_token")},cache:!1,data:"POST"==c||"PUT"==c||"DELETE"==c?a:null,params:"GET"==c?a:null};return o(p).success(function(e){if("SUCCESS"==e.res||1==e.res)l.resolve(e),u&&n.success(u);else if("FAILED"==e.res){if(l.reject(e),!e.error.code)return void n.error("返回信息不符合规则，超出预料范围，请联系程序员！");t.go("login"),i.clearCookie("auth_token"),n.error(e.error.message)}else n.error("返回数据异常，请联系程序员！")}).error(function(e,o){n.error("HTTP请求错误，请F5刷新或联系开发人员")}),l.promise}return c}]);
app.controller("adminController",["$scope","alertify","myHttp","myCookie","$state",function(e,o,n,a,m){var t={menuInfo:[{moduleName:"门店管理",menu:[{menuName:"门店信息",route:"admin.branch"},{menuName:"区域管理",route:"admin.launch"}]}]};t?(e.manageName=localStorage.getItem("name"),e.menuData=t.menuInfo):m.go("login"),e.logout=function(){a.clearCookie("auth_token"),m.go("login"),o.success("登出成功")}}]);
app.controller("branchController",["$scope","alertify","myHttp",function(t,l,o){t.title=["全部","大胖","二胖","三胖","四胖"],t.temp=0,t.page=100,t.say=function(t){},t.bdhtml="<div>bdhtml|trustHtml绑定html</div>"}]),app.controller("launchController",["$scope","alertify","myHttp",function(t,l,o){t.listData="launchController"}]);
app.controller("loginController",["$scope","alertify","myHttp","myCookie","$state",function(a,e,t,o,n){a.data={},a.login=function(){a.data.userName?(localStorage.setItem("name",a.data.userName),n.go("admin.branch"),e.success("登录成功")):e.alert("输入用户名")}}]);